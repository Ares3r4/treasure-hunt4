<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Christmas Memory Puzzle</title>
<style>
/* Body */
body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(#b30000, #4d0000);
    color: white;
    text-align: center;
    padding: 20px;
    overflow-x: hidden;
    position: relative;
}

/* Heading */
h1 {
    font-size: calc(20px + 2vw);
    margin-bottom: 10px;
}

/* Game grid */
#game {
    width: 90vw;
    max-width: 400px;
    margin: 20px auto;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    position: relative;
    z-index: 1;
}

/* Cards */
.card {
    width: 100%;
    aspect-ratio: 1/1;
    background: white;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: calc(24px + 2vw);
    cursor: pointer;
    user-select: none;
    transform-style: preserve-3d;
    transition: transform 0.4s;
    position: relative;
    z-index: 2;
}

.card.flipped { transform: rotateY(180deg); }

.front, .back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 10px;
}

.back { background: white; font-size: calc(20px + 2vw); }
.front { background: #8b0000; transform: rotateY(180deg); font-size: calc(24px + 2vw); }

/* Message */
#message {
    margin-top: 20px;
    font-size: calc(18px + 2vw);
    opacity: 0;
    transition: opacity 0.6s;
    position: relative;
    z-index: 9999;
}

.show {
    opacity: 1;
    animation: glow 1.4s infinite alternate;
}

@keyframes glow {
    from { text-shadow: 0 0 10px gold; }
    to { text-shadow: 0 0 30px white; }
}

/* Confetti */
.confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background-color: gold;
    top: -10px;
    z-index: 9999;
    pointer-events: none;
    opacity: 0.9;
    border-radius: 50%;
    animation: fall 3s linear forwards;
}

@keyframes fall {
    to { transform: translateY(100vh) rotate(360deg); opacity: 0; }
}

/* Snow */
.snowflake {
    position: fixed;
    top: -10px;
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    opacity: 0.8;
    z-index: 0;
    pointer-events: none;
    animation: snowFall linear infinite;
}

@keyframes snowFall {
    0% { transform: translateY(0) translateX(0); }
    100% { transform: translateY(100vh) translateX(50px); }
}
</style>
</head>
<body>

<h1>üéÑ Christmas Memory Match üéÑ</h1>
<p>Find all the matching pairs to reveal the next clue!</p>

<div id="game"></div>
<div id="message">üéÑ Congratulations!<br>‚û°Ô∏è Head to the <b>LIBRARY CAFE</b>!</div>

<script>
// Card setup
const icons = ["üéÑ","üéÅ","üç™","‚ùÑ","üìò","‚òï"];
let cardValues = [...icons, ...icons];
cardValues.sort(() => Math.random() - 0.5);

const game = document.getElementById("game");
const message = document.getElementById("message");

let firstCard = null;
let lockBoard = false;
let matchedPairs = 0;
const totalPairs = icons.length;

// Create cards with named click handlers
cardValues.forEach(icon => {
    const card = document.createElement('div');
    card.classList.add('card');
    card.dataset.icon = icon;
    card.innerHTML = `<div class="back">üéÖ</div><div class="front">${icon}</div>`;

    function clickHandler() { flipCard(card); }
    card.addEventListener('click', clickHandler);
    card.clickHandler = clickHandler;

    game.appendChild(card);
});

// Flip logic
function flipCard(card) {
    if (lockBoard || card.classList.contains('flipped')) return;
    card.classList.add('flipped');

    if (!firstCard) {
        firstCard = card;
        return;
    }

    lockBoard = true;
    const secondCard = card;

    setTimeout(() => {
        if (firstCard.dataset.icon === secondCard.dataset.icon) {
            matchedPairs++;
            firstCard.removeEventListener('click', firstCard.clickHandler);
            secondCard.removeEventListener('click', secondCard.clickHandler);
        } else {
            firstCard.classList.remove('flipped');
            secondCard.classList.remove('flipped');
        }

        firstCard = null;
        lockBoard = false;

        if (matchedPairs === totalPairs) {
            message.classList.add('show');
            launchConfetti(100);
        }
    }, 450);
}

// Confetti
function launchConfetti(count) {
    for (let i=0; i<count; i++) {
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = Math.random() * window.innerWidth + 'px';
        c.style.backgroundColor = randomColor();
        const size = Math.random()*8 + 5;
        c.style.width = c.style.height = size + 'px';
        c.style.animationDuration = 2 + Math.random()*2 + 's';
        document.body.appendChild(c);
        c.addEventListener('animationend', () => c.remove());
    }
}

function randomColor() {
    const colors = ['#FFD700','#FF4500','#00FFFF','#FF69B4','#ADFF2F','#FFFFFF'];
    return colors[Math.floor(Math.random() * colors.length)];
}

// Snow
function createSnowflake() {
    const snow = document.createElement('div');
    snow.className = 'snowflake';
    snow.style.left = Math.random() * window.innerWidth + 'px';
    snow.style.width = snow.style.height = Math.random()*5 + 3 + 'px';
    snow.style.animationDuration = 5 + Math.random()*5 + 's';
    document.body.appendChild(snow);
    snow.addEventListener('animationend', () => snow.remove());
}
setInterval(createSnowflake, 200);

</script>

</body>
</html>
